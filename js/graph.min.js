var Graph={cursor1:null,cursor2:null,curspan:null,dygraph:null,interval:false,curTime1:0,curTime2:0,beginTime:0,stepTime:0,area:null,rows:0,ppr:0,sources:null,timeHandle:null,generateColours:function(n){var colours=[];if(n<=10){var step=360/n;for(var i=0;i<n;i++){colours[i]="hsl("+(step*i)+", 75%, 50%)";}}
else if(n<=24){}
return colours;},placeCursor:function(cursor,row){cursor.style.left=(this.area.x+row*this.ppr)+"px";if(cursor==this.cursor1){this.curTime1=this.beginTime+this.stepTime*row;}
else if(cursor==this.cursor2){this.curTime2=this.beginTime+this.stepTime*row;}},init:function(canvasDomId,gData,gLegend,gTitle,render){this.sources=gLegend;gLegend.unshift("x");var options={colors:this.generateColours(gLegend.length-1),labels:gLegend,legend:'always',ylabel:gTitle,axes:{y:{axisLabelWidth:70}},stackedGraph:render["type"],fillGraph:render["style"],labelsKMG2:true,highlightCircleSize:5,panEdgeFraction:0.1,interactionModel:{}};this.dygraph=new Dygraph(document.getElementById(canvasDomId),gData,options);},initCursor:function(arr_cursorDomIds){this.area=this.dygraph.getArea();this.rows=this.dygraph.numRows();this.ppr=this.area.w/(this.rows-1);this.cursor1=document.getElementById(arr_cursorDomIds[0]);this.cursor2=document.getElementById(arr_cursorDomIds[1]);this.curspan=document.getElementById(arr_cursorDomIds[2]);this.cursor1.style.position="absolute";this.cursor1.style.height=this.area.h+"px";this.cursor1.style.width="2px";this.cursor1.style.background="black";this.cursor2.style.position="absolute";this.cursor2.style.height=this.area.h+"px";this.cursor2.style.width="2px";this.cursor2.style.background="black";this.cursor2.style.display="none";this.curspan.style.position="absolute";this.curspan.style.height=this.area.h+"px";this.curspan.style.background="#00FF00";this.curspan.style.opacity="0.2";this.curspan.style.display="none";},initTime:function(begin,end){this.beginTime=begin;this.stepTime=(end-begin)/(this.rows-1);this.placeCursor(this.cursor1,this.rows/2);},registerCallback:function(foo){this.timeHandle=foo;},update:function(newData,newTitle,render){this.dygraph.updateOptions({file:newData,ylabel:newTitle,stackedGraph:render["type"],fillGraph:render["style"]});},updateRenderMode:function(prms){this.dygraph.updateOptions({stackedGraph:prms["type"],fillGraph:prms["style"]});},updateSourcesVisibility:function(srcDomId){var srcs=document.getElementById(srcDomId).getElementsByTagName("input");for(var i=0;i<srcs.length;i++){this.dygraph.setVisibility(i,srcs[i].checked);}},moveCursor:function(){var row=Graph.dygraph.getSelection();Graph.placeCursor(Graph.cursor1,row);Graph.interval=false;var caller=this;var swapped=false;caller.onmousemove=function(eventE){Graph.interval=true;Graph.cursor2.style.display="";Graph.curspan.style.display="";var row2=Graph.dygraph.getSelection();if((row2<row&&!swapped)||(row2>row&&swapped)){swapped=!swapped;}
Graph.placeCursor(Graph.curspan,swapped?row2:row);Graph.curspan.style.width=(Math.abs(row2-row)*Graph.ppr)+"px";Graph.placeCursor(Graph.cursor1,swapped?row2:row);Graph.placeCursor(Graph.cursor2,swapped?row:row2);}
caller.onmouseup=function(){if(!Graph.interval){Graph.cursor2.style.display="none";Graph.curspan.style.display="none";Graph.curTime2=-1;}
if(Graph.timeHandle!=null){Graph.timeHandle();}
caller.onmousemove=null;}},};