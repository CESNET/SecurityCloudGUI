function Dbqry_parseQuerryParameter(tab){var timeSpec="-t "+Graph.curTime1;if(Graph.interval){timeSpec+="#"+Graph.curTime2;}
else{timeSpec+="#"+Graph.curTime1;}
var limitSel=document.getElementById("Option_LimitTo_"+tab);var limitTo=limitSel.options[limitSel.selectedIndex].value;var aggreg="";if(document.getElementById("Option_AggregateList_"+tab).value!=""){aggreg="-a "+document.getElementById("Option_AggregateList_"+tab).value;}
var orderSel=document.getElementById("Option_OrderBy_"+tab);var orderBy="";if(orderSel.options[orderSel.selectedIndex].value!="none"){orderBy="-o "+orderSel.options[orderSel.selectedIndex].value;orderSel=document.getElementById("Option_OrderDirection_"+tab);orderBy+=orderSel.options[orderSel.selectedIndex].value;}
var outputSel=document.getElementById("Option_OutputFormat_"+tab);var output="--output-format="+outputSel.options[outputSel.selectedIndex].value;if(document.getElementById("Option_OutputNoSummary_"+tab).checked){output+=" --no-summary";}
var str=timeSpec+" "+limitTo+" "+aggreg+" "+orderBy+" "+output;return str;}
function Dbqry_stopDbRequest(tab){debugLog("Attempting to kill the request");var ajaxRequest=Utility.initAjax();ajaxRequest.onreadystatechange=function(){if(ajaxRequest.readyState==4){var output=ajaxRequest.responseText;debugLog("stopDbRequest("+tab+") - db-manage output: "+output);}}
ajaxRequest.open("GET","php/db-manage.php?mode=kill&stamp="+USERSTAMP+"&tab="+tab,true);ajaxRequest.send();}
function Dbqry_processDbRequest(tab){var ajaxRequest=Globals_initAjax();var filter;if(document.getElementById("Db_Filter_"+tab).value.length>=1){filter="-f "+document.getElementById("Db_Filter_"+tab).value;}
else{filter="";}
var opts=Dbqry_parseQuerryParameter(tab);filter=encodeURIComponent(filter);opts=encodeURIComponent(opts);debugLog("processDbRequest(...) - Selected options are: "+opts);ajaxRequest.onreadystatechange=function(){if(ajaxRequest.readyState==4){document.getElementById("Dbqry_Output_"+tab).innerHTML=ajaxRequest.responseText;document.getElementById("Dbqry_ProcessButton_"+tab).style.display="";document.getElementById("Db_Submit_StopButton_"+tab).style.display="none";}}
document.getElementById("Dbqry_Submit_ProcessButton_"+tab).style.display="none";document.getElementById("Dbqry_Submit_StopButton_"+tab).style.display="";ajaxRequest.open("GET","php/dbqry/database.php?stamp="+USERSTAMP+"&tab="+tab+"&profile="+PROFILE+"&opts="+opts+"&filter="+filter,true);ajaxRequest.send(null);}